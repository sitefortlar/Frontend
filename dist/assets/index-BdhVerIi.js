import{c as z,F as J,r as u,H as Q,j as e,J as B,K as T,a6 as W,a7 as Z,a4 as Y,i as $,u as ee,a8 as M,B as P,X as te,t as se}from"./index-hV2YQk7K.js";import{C as re,a as oe,b as ne,c as ae,d as ie}from"./card-CdyJUX28.js";import{A as N,b as q,a as R,U as _}from"./alert-DWAaLv0W.js";import{u as ce,B as de,L as A}from"./BaseService-D-clKh8p.js";import{C as le}from"./check-BfzSPuf9.js";import{L as ue}from"./loader-circle-CZWR_OwY.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=z("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=z("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);var w="Checkbox",[me,Pe]=J(w),[xe,I]=me(w);function fe(o){const{__scopeCheckbox:t,checked:s,children:r,defaultChecked:n,disabled:a,form:f,name:l,onCheckedChange:p,required:h,value:c="on",internal_do_not_use_render:d}=o,[y,k]=Y({prop:s,defaultProp:n??!1,onChange:p,caller:w}),[b,C]=u.useState(null),[j,m]=u.useState(null),g=u.useRef(!1),i=b?!!f||!!b.closest("form"):!0,x={checked:y,disabled:a,setChecked:k,control:b,setControl:C,name:l,form:f,value:c,hasConsumerStoppedPropagationRef:g,required:h,defaultChecked:S(n)?!1:n,isFormControl:i,bubbleInput:j,setBubbleInput:m};return e.jsx(xe,{scope:t,...x,children:ge(d)?d(x):r})}var L="CheckboxTrigger",U=u.forwardRef(({__scopeCheckbox:o,onKeyDown:t,onClick:s,...r},n)=>{const{control:a,value:f,disabled:l,checked:p,required:h,setControl:c,setChecked:d,hasConsumerStoppedPropagationRef:y,isFormControl:k,bubbleInput:b}=I(L,o),C=Q(n,c),j=u.useRef(p);return u.useEffect(()=>{const m=a==null?void 0:a.form;if(m){const g=()=>d(j.current);return m.addEventListener("reset",g),()=>m.removeEventListener("reset",g)}},[a,d]),e.jsx(B.button,{type:"button",role:"checkbox","aria-checked":S(p)?"mixed":p,"aria-required":h,"data-state":G(p),"data-disabled":l?"":void 0,disabled:l,value:f,...r,ref:C,onKeyDown:T(t,m=>{m.key==="Enter"&&m.preventDefault()}),onClick:T(s,m=>{d(g=>S(g)?!0:!g),b&&k&&(y.current=m.isPropagationStopped(),y.current||m.stopPropagation())})})});U.displayName=L;var F=u.forwardRef((o,t)=>{const{__scopeCheckbox:s,name:r,checked:n,defaultChecked:a,required:f,disabled:l,value:p,onCheckedChange:h,form:c,...d}=o;return e.jsx(fe,{__scopeCheckbox:s,checked:n,defaultChecked:a,disabled:l,required:f,onCheckedChange:h,name:r,form:c,value:p,internal_do_not_use_render:({isFormControl:y})=>e.jsxs(e.Fragment,{children:[e.jsx(U,{...d,ref:t,__scopeCheckbox:s}),y&&e.jsx(H,{__scopeCheckbox:s})]})})});F.displayName=w;var V="CheckboxIndicator",D=u.forwardRef((o,t)=>{const{__scopeCheckbox:s,forceMount:r,...n}=o,a=I(V,s);return e.jsx(W,{present:r||S(a.checked)||a.checked===!0,children:e.jsx(B.span,{"data-state":G(a.checked),"data-disabled":a.disabled?"":void 0,...n,ref:t,style:{pointerEvents:"none",...o.style}})})});D.displayName=V;var O="CheckboxBubbleInput",H=u.forwardRef(({__scopeCheckbox:o,...t},s)=>{const{control:r,hasConsumerStoppedPropagationRef:n,checked:a,defaultChecked:f,required:l,disabled:p,name:h,value:c,form:d,bubbleInput:y,setBubbleInput:k}=I(O,o),b=Q(s,k),C=ce(a),j=Z(r);u.useEffect(()=>{const g=y;if(!g)return;const i=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(i,"checked").set,E=!n.current;if(C!==a&&v){const X=new Event("click",{bubbles:E});g.indeterminate=S(a),v.call(g,S(a)?!1:a),g.dispatchEvent(X)}},[y,C,a,n]);const m=u.useRef(S(a)?!1:a);return e.jsx(B.input,{type:"checkbox","aria-hidden":!0,defaultChecked:f??m.current,required:l,disabled:p,name:h,value:c,form:d,...t,tabIndex:-1,ref:b,style:{...t.style,...j,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});H.displayName=O;function ge(o){return typeof o=="function"}function S(o){return o==="indeterminate"}function G(o){return S(o)?"indeterminate":o?"checked":"unchecked"}const K=u.forwardRef(({className:o,...t},s)=>e.jsx(F,{ref:s,className:$("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",o),...t,children:e.jsx(D,{className:$("flex items-center justify-center text-current"),children:e.jsx(le,{className:"h-4 w-4"})})}));K.displayName=F.displayName;class ye extends de{constructor(){super("/products")}async getProducts(t={}){const s=this.buildQueryString(t),r=s?`?${s}`:"";return this.get(r)}async getProductById(t){return this.get(`/${t}`)}async getProductsByCategory(t,s={}){const r=this.buildQueryString({...s,category:t}),n=r?`?${r}`:"";return this.get(`/category/${t}${n}`)}async searchProducts(t,s={}){const r=this.buildQueryString({...s,search:t}),n=r?`?${r}`:"";return this.get(`/search${n}`)}async getSearchSuggestions(t,s=5){const r=this.buildQueryString({query:t,limit:s});return this.get(`/search/suggestions?${r}`)}async getRelatedProducts(t,s=4){const r=this.buildQueryString({limit:s});return this.get(`/${t}/related?${r}`)}async getFeaturedProducts(t=8){const s=this.buildQueryString({limit:t});return this.get(`/featured?${s}`)}async getBestSellers(t=8){const s=this.buildQueryString({limit:t});return this.get(`/best-sellers?${s}`)}async getPromotionalProducts(t=8){const s=this.buildQueryString({limit:t});return this.get(`/promotional?${s}`)}async getCategories(){return this.get("/categories")}async getCategoryById(t){return this.get(`/categories/${t}`)}async getProductsByPriceRange(t,s,r={}){const n=this.buildQueryString({...r,minPrice:t,maxPrice:s});return this.get(`?${n}`)}async getProductsBySize(t,s={}){const r=this.buildQueryString({...s,sizes:[t]});return this.get(`?${r}`)}async getProductsByPriceType(t,s={}){const r=this.buildQueryString({...s,priceType:t});return this.get(`?${r}`)}async getProductsSorted(t,s="asc",r={}){const n=this.buildQueryString({...r,sortBy:t,sortOrder:s});return this.get(`?${n}`)}async getProductsWithFilters(t){const s=this.buildQueryString(t),r=s?`?${s}`:"";return this.get(r)}async getProductStats(){return this.get("/stats")}async upload(t){var l,p,h,c;const s=["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],r=[".csv",".xls",".xlsx"],n=t.name.toLowerCase().substring(t.name.lastIndexOf("."));if(!(s.includes(t.type)||r.includes(n)))throw new Error("Tipo de arquivo inválido. Apenas arquivos CSV ou Excel (.csv, .xls, .xlsx) são permitidos.");const f=new FormData;f.append("file",t);try{await this.client.post("/product",f)}catch(d){if(d.response){const y=((p=(l=d.response)==null?void 0:l.data)==null?void 0:p.message)||((c=(h=d.response)==null?void 0:h.data)==null?void 0:c.error)||"Erro ao fazer upload do arquivo";throw new Error(y)}throw d}}}const be=new ye,ve=()=>{const[o,t]=u.useState(null),[s,r]=u.useState(!1),[n,a]=u.useState(!1),[f,l]=u.useState("idle"),[p,h]=u.useState(""),c=u.useRef(null),{toast:d}=ee(),y=[".csv",".xls",".xlsx"],k=["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],b=i=>{const x=i.name.toLowerCase().substring(i.name.lastIndexOf(".")),v=y.includes(x),E=k.includes(i.type);return v||E},C=i=>{var v;const x=(v=i.target.files)==null?void 0:v[0];if(x){if(!b(x)){d({title:"Tipo de arquivo inválido",description:"Apenas arquivos CSV ou Excel (.csv, .xls, .xlsx) são permitidos.",variant:"destructive"}),t(null),r(!1),c.current&&(c.current.value="");return}t(x),r(!1),l("idle"),h("")}},j=()=>{t(null),r(!1),l("idle"),h(""),c.current&&(c.current.value="")},m=async()=>{if(!(!o||!s)){a(!0),l("idle"),h("");try{await be.upload(o),l("success"),d({title:"Sucesso!",description:"Produtos importados com sucesso."}),setTimeout(()=>{t(null),r(!1),l("idle"),c.current&&(c.current.value="")},3e3)}catch(i){l("error");const x=i.message||"Erro ao fazer upload do arquivo. Tente novamente.";h(x),d({title:"Erro no upload",description:x,variant:"destructive"})}finally{a(!1)}}},g=i=>{if(i===0)return"0 Bytes";const x=1024,v=["Bytes","KB","MB","GB"],E=Math.floor(Math.log(i)/Math.log(x));return Math.round(i/Math.pow(x,E)*100)/100+" "+v[E]};return e.jsxs(re,{children:[e.jsxs(oe,{children:[e.jsx(ne,{children:"Upload de Arquivo"}),e.jsx(ae,{children:"Selecione um arquivo CSV ou Excel para importar produtos"})]}),e.jsxs(ie,{className:"space-y-6",children:[e.jsxs(N,{variant:"destructive",children:[e.jsx(M,{className:"h-4 w-4"}),e.jsx(q,{children:"Atenção"}),e.jsxs(R,{children:["Este processo apagará ",e.jsx("strong",{children:"todos os produtos cadastrados atualmente"})," e os substituirá pelos dados do arquivo enviado."]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"file-upload",children:"Arquivo (CSV ou Excel)"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{ref:c,id:"file-upload",type:"file",accept:".csv,.xls,.xlsx,text/csv,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",onChange:C,className:"hidden"}),e.jsxs(P,{type:"button",variant:"outline",onClick:()=>{var i;return(i=c.current)==null?void 0:i.click()},disabled:n,children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Selecionar Arquivo"]}),o&&e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx(he,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm text-muted-foreground flex-1",children:[o.name," (",g(o.size),")"]}),e.jsx(P,{type:"button",variant:"ghost",size:"icon",onClick:j,disabled:n,children:e.jsx(te,{className:"h-4 w-4"})})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Formatos aceitos: .csv, .xls, .xlsx"})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-4 border rounded-lg bg-muted/50",children:[e.jsx(K,{id:"confirm-replace",checked:s,onCheckedChange:i=>r(i===!0),disabled:!o||n}),e.jsx(A,{htmlFor:"confirm-replace",className:"text-sm font-normal leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:"Estou ciente de que os produtos atuais serão substituídos pelos dados do arquivo enviado."})]}),f==="success"&&e.jsxs(N,{children:[e.jsx(pe,{className:"h-4 w-4"}),e.jsx(q,{children:"Sucesso!"}),e.jsx(R,{children:"Produtos importados com sucesso."})]}),f==="error"&&p&&e.jsxs(N,{variant:"destructive",children:[e.jsx(M,{className:"h-4 w-4"}),e.jsx(q,{children:"Erro"}),e.jsx(R,{children:p})]}),e.jsx(P,{onClick:m,disabled:!o||!s||n,className:"w-full",size:"lg",children:n?e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"h-4 w-4 mr-2 animate-spin"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Enviar Arquivo"]})})]})]})},Ne=()=>e.jsxs("div",{className:"container mx-auto p-6 space-y-6 max-w-4xl",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(se,{className:"h-8 w-8"}),"Gerenciamento de Produtos"]}),e.jsxs("p",{className:"text-muted-foreground mt-2",children:["Envie um arquivo CSV ou Excel para cadastrar ou atualizar os produtos.",e.jsx("br",{}),"O envio substituirá todos os produtos existentes."]})]}),e.jsx(ve,{})]});export{Ne as default};
